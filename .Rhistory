df_lca$region_grouped
# Convert to factor and set "Other" as the reference level
df_lca$region_grouped <- relevel(
factor(df_lca$region_grouped),
ref = "Other"
)
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
+ ecosystem
+ encourage_repo_use
+ data_literacy_binary , data = df_lca)
# Summarize model
summary_model <- summary(model)
# Extract coefficients and standard errors
coeffs <- summary_model$coefficients
ses <- summary_model$standard.errors
# Calculate p-values
z_values <- coeffs / ses
p_values <- 2 * (1 - pnorm(abs(z_values)))
# Function to add significance stars
significance_stars <- function(p) {
ifelse(p < 0.001, "***", ifelse(p < 0.01, "**", ifelse(p < 0.05, "*", "")))
}
# Apply significance stars
stars <- apply(p_values, c(1, 2), significance_stars)
# Create a summary table
results <- data.frame(
Coefficient = as.vector(coeffs),
`p-value` = as.vector(p_values),
Significance = as.vector(stars),
Class = rep(colnames(coeffs), each = nrow(coeffs)),
Variable = rep(rownames(coeffs), times = ncol(coeffs))
)
results
df_lca$encourage_data_use <- ifelse(df_lca$Q6.2 == "Strongly agree" |
df_lca$Q6.2 == "Somewhat agree",
1, 0)
df_lca$strong_encourage_data_use <- ifelse(df_lca$Q6.2 == "Strongly agree",
1, 0)
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ encourage_data_use
+ data_literacy_binary , data = df_lca)
# Summarize model
summary_model <- summary(model)
# Extract coefficients and standard errors
coeffs <- summary_model$coefficients
ses <- summary_model$standard.errors
# Calculate p-values
z_values <- coeffs / ses
p_values <- 2 * (1 - pnorm(abs(z_values)))
# Function to add significance stars
significance_stars <- function(p) {
ifelse(p < 0.001, "***", ifelse(p < 0.01, "**", ifelse(p < 0.05, "*", "")))
}
# Apply significance stars
stars <- apply(p_values, c(1, 2), significance_stars)
# Create a summary table
results <- data.frame(
Coefficient = as.vector(coeffs),
`p-value` = as.vector(p_values),
Significance = as.vector(stars),
Class = rep(colnames(coeffs), each = nrow(coeffs)),
Variable = rep(rownames(coeffs), times = ncol(coeffs))
)
results
results
df_lca %>% filter(membership == 1)
df_lca %>% filterclass_(membership == 1)
df_lca %>% filter(class_membership == 1)
df_lca %>% filter(class_membership == 1) %>% select(region_grouped) %>% table()
df_lca %>% filter(class_membership == 1) %>% dplyr::select(region_grouped) %>% table()
df_lca %>% filter(class_membership == 2) %>% dplyr::select(region_grouped) %>% table()
df_lca %>% filter(class_membership == 3) %>% dplyr::select(region_grouped) %>% table()
table(df_lca$class_membership)
table(df_lca$marine_ecosystem)
table(df_lca$freshwater_ecosystem)
table(df_lca$coastal_ecosystem)
table(df_lca$ecosystem)
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary , data = df_lca)
# Summarize model
summary_model <- summary(model)
# Extract coefficients and standard errors
coeffs <- summary_model$coefficients
ses <- summary_model$standard.errors
# Calculate p-values
z_values <- coeffs / ses
p_values <- 2 * (1 - pnorm(abs(z_values)))
# Function to add significance stars
significance_stars <- function(p) {
ifelse(p < 0.001, "***", ifelse(p < 0.01, "**", ifelse(p < 0.05, "*", "")))
}
# Apply significance stars
stars <- apply(p_values, c(1, 2), significance_stars)
# Create a summary table
results <- data.frame(
Coefficient = as.vector(coeffs),
`p-value` = as.vector(p_values),
Significance = as.vector(stars),
Class = rep(colnames(coeffs), each = nrow(coeffs)),
Variable = rep(rownames(coeffs), times = ncol(coeffs))
)
results
reg_dat <- df_lca %>% dplyr::select(class_membership,
affiliation_grouped,
area_of_work_grouped,
region_grouped,
# ecosystem,
marine_ecosystem,
freshwater_ecosystem,
coastal_ecosystem,
encourage_data_use,
data_literacy_binary,)
# correlation for all variables
cor <- round(cor(reg_dat),
digits = 2 # rounded to 2 decimals
)
image(cor, main = "Correlation Matrix", col = colorRampPalette(c("blue", "white", "red"))(20))
reg_dat <- df_lca %>% dplyr::select(class_membership,
affiliation_grouped,
area_of_work_grouped,
region_grouped,
# ecosystem,
marine_ecosystem,
freshwater_ecosystem,
coastal_ecosystem,
encourage_data_use,
data_literacy_binary,)
# correlation for all variables
cor <- round(cor(reg_dat),
digits = 2 # rounded to 2 decimals
)
cor(reg_dat)
library(car)
library(nnet)
library(dplyr)
# Fit a multiple linear regression model
model <- lm(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binar, data = df_lca)
# Fit a multiple linear regression model
model <- lm(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary, data = df_lca)
# Compute VIF for each predictor variable
vif_values <- vif(model)
# Display results
print(vif_values)
df_lca <- df_lca %>%
mutate(affiliation_grouped = case_when(
affiliation %in% c("Local or regional governmental institution",
"National governmental institution",
"European Union and its agencies") ~ "Policy-making",
affiliation %in% c("Other academic research institution",
"University") ~ "Scientific",
affiliation %in% c("Nongovernmental organization (NGO)",
"International organization") ~ "NGO-IGO",
affiliation == "Business and Industry" ~ "Business",
affiliation %in% c("Other", "Local association") ~ "Other",
TRUE ~ NA_character_  # For any unmatched values
))
df_lca$affiliation_grouped <- relevel(factor(df_lca$affiliation_grouped), ref = "Other")
# Recode area_of_work into a new grouped variable
df_lca$area_of_work_grouped <- case_when(
df_lca$area_of_work %in% c(
"Media and communication",
"Product development and construction",
"Public engagement",
"Other"
) ~ "Other",
TRUE ~ df_lca$area_of_work
)
# Convert to factor and set "Other" as the reference level
df_lca$area_of_work_grouped <- relevel(
factor(df_lca$area_of_work_grouped),
ref = "Other"
)
df_lca$region_grouped <- case_when(
df_lca$region %in% c("Latin America & Caribbean", "Africa") ~ "Global South (Africa + LAC)",
df_lca$region %in% c("Asia", "Western Asia", "Oceania") ~ "Asia-Pacific",
df_lca$region %in% c("Eastern Europe", "Southern Europe") ~ "Eastern & Southern Europe",
TRUE ~ df_lca$region  # Keep all other categories as-is
)
# Convert to factor and set "Other" as the reference level
df_lca$region_grouped <- relevel(
factor(df_lca$region_grouped),
ref = "Other"
)
# Fit a multiple linear regression model
model <- lm(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary, data = df_lca)
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary , data = df_lca)
vif(model)
model <- lm(~ data_literacy_binary + region + affiliation_grouped + ecosystem, data = df_lca)
barplot(vif_values, col = "skyblue", main = "Variance Inflation Factor (VIF)")
vif_values
vif_values <- vif(model)
df_lca <- df_lca %>%
mutate(affiliation_grouped = case_when(
affiliation %in% c("Local or regional governmental institution",
"National governmental institution",
"European Union and its agencies") ~ "Policy-making",
affiliation %in% c("Other academic research institution",
"University") ~ "Scientific",
affiliation %in% c("Nongovernmental organization (NGO)",
"International organization") ~ "NGO-IGO",
affiliation == "Business and Industry" ~ "Business",
affiliation %in% c("Other", "Local association") ~ "Other",
TRUE ~ NA_character_  # For any unmatched values
))
# Convert to factor and set "Other" as the reference level
df_lca$affiliation_grouped <- relevel(
factor(df_lca$affiliation_grouped),
ref = "Other"
)
df_lca$affiliation_grouped <- relevel(factor(df_lca$affiliation_grouped), ref = "Other")
# Recode area_of_work into a new grouped variable
df_lca$area_of_work_grouped <- case_when(
df_lca$area_of_work %in% c(
"Media and communication",
"Product development and construction",
"Public engagement",
"Other"
) ~ "Other",
TRUE ~ df_lca$area_of_work
)
# Convert to factor and set "Other" as the reference level
df_lca$area_of_work_grouped <- relevel(
factor(df_lca$area_of_work_grouped),
ref = "Other"
)
df_lca$region_grouped <- case_when(
df_lca$region %in% c("Latin America & Caribbean", "Africa") ~ "Global South (Africa + LAC)",
df_lca$region %in% c("Asia", "Western Asia", "Oceania") ~ "Asia-Pacific",
df_lca$region %in% c("Eastern Europe", "Southern Europe") ~ "Eastern & Southern Europe",
TRUE ~ df_lca$region  # Keep all other categories as-is
)
# Convert to factor and set "Other" as the reference level
df_lca$region_grouped <- relevel(
factor(df_lca$region_grouped),
ref = "Other"
)
# Fit a multiple linear regression model
model <- lm(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary, data = df_lca)
model <- lm(numeric_outcome ~ data_literacy_binary + region + affiliation_grouped + ecosystem, data = df)
model <- lm( ~ data_literacy_binary + region + affiliation_grouped + ecosystem, data = df)
model <- lm( ~ data_literacy_binary + region + affiliation_grouped + ecosystem, data = df_lca)
# Fit a multiple linear regression model
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary, data = df_lca)
# Compute VIF for each predictor variable
vif_values <- vif(model)
# Display results
print(vif_values)
barplot(vif_values, col = "skyblue", main = "Variance Inflation Factor (VIF)")
barplot(vif_values, col = "skyblue", main = "Variance Inflation Factor (VIF)")
vif_values
vif_df <- data.frame(
Variable = rownames(vif_values),
GVIF = vif_values[, "GVIF"],
Df = vif_values[, "Df"],
Adjusted_VIF = vif_values[, "GVIF^(1/(2*Df))"]
)
# Add interpretation
vif_df$Interpretation <- cut(vif_df$Adjusted_VIF,
breaks = c(-Inf, 2, 5, 10, Inf),
labels = c("Low", "Moderate", "High", "Very High")
)
print(vif_df)
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary , data = df_lca)
# Summarize model
summary_model <- summary(model)
# Extract coefficients and standard errors
coeffs <- summary_model$coefficients
ses <- summary_model$standard.errors
# Calculate p-values
z_values <- coeffs / ses
p_values <- 2 * (1 - pnorm(abs(z_values)))
# Function to add significance stars
significance_stars <- function(p) {
ifelse(p < 0.001, "***", ifelse(p < 0.01, "**", ifelse(p < 0.05, "*", "")))
}
# Apply significance stars
stars <- apply(p_values, c(1, 2), significance_stars)
# Create a summary table
results <- data.frame(
Coefficient = as.vector(coeffs),
`p-value` = as.vector(p_values),
Significance = as.vector(stars),
Class = rep(colnames(coeffs), each = nrow(coeffs)),
Variable = rep(rownames(coeffs), times = ncol(coeffs))
)
results
# Relevel the outcome variable so that "3" is the reference
df_lca$class_membership <- relevel(factor(df_lca$class_membership), ref = "3")
# Conduct multinomial logistic regression
model <- multinom(class_membership ~
data_literacy_binary
+ strong_encourage_repo_use
+ policy_bin
+ scientific_bin
+ business_bin
+ ngo_igo_bin
# + affiliation_local
# + affiliation_national
# + affiliation_international
+ academia_research
+ public_engagement
+ product_development
+ conservation_management
+ data_management
+ management_administration
+ law_policy_decision
+ media_communication
+ marine_ecosystem
+ coastal_ecosystem
+ freshwater_ecosystem
+ terrestrial_ecosystem
+ southern_europe
+ western_europe
+ northern_europe
+ northern_america
+ latin_america_caribbean
# + other
#+ encourage_repo_use
, data = df_lca)
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary , data = df_lca)
# Extract coefficients and standard errors
coeffs <- summary_model$coefficients
ses <- summary_model$standard.errors
# Calculate p-values
z_values <- coeffs / ses
p_values <- 2 * (1 - pnorm(abs(z_values)))
# Function to add significance stars
significance_stars <- function(p) {
ifelse(p < 0.001, "***", ifelse(p < 0.01, "**", ifelse(p < 0.05, "*", "")))
}
# Apply significance stars
stars <- apply(p_values, c(1, 2), significance_stars)
# Create a summary table
results2 <- data.frame(
Coefficient = as.vector(coeffs),
`p-value` = as.vector(p_values),
Significance = as.vector(stars),
Class = rep(colnames(coeffs), each = nrow(coeffs)),
Variable = rep(rownames(coeffs), times = ncol(coeffs))
)
results2
model
# Summarize model
summary_model <- summary(model)
# Extract coefficients and standard errors
coeffs <- summary_model$coefficients
ses <- summary_model$standard.errors
# Calculate p-values
z_values <- coeffs / ses
p_values <- 2 * (1 - pnorm(abs(z_values)))
# Function to add significance stars
significance_stars <- function(p) {
ifelse(p < 0.001, "***", ifelse(p < 0.01, "**", ifelse(p < 0.05, "*", "")))
}
# Apply significance stars
stars <- apply(p_values, c(1, 2), significance_stars)
# Create a summary table
results2 <- data.frame(
Coefficient = as.vector(coeffs),
`p-value` = as.vector(p_values),
Significance = as.vector(stars),
Class = rep(colnames(coeffs), each = nrow(coeffs)),
Variable = rep(rownames(coeffs), times = ncol(coeffs))
)
results2
results
# Relevel the outcome variable so that "2" is the reference
df_lca$class_membership <- relevel(factor(df_lca$class_membership), ref = "2")
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary , data = df_lca)
# Summarize model
summary_model <- summary(model)
# Extract coefficients and standard errors
coeffs <- summary_model$coefficients
ses <- summary_model$standard.errors
# Calculate p-values
z_values <- coeffs / ses
p_values <- 2 * (1 - pnorm(abs(z_values)))
# Function to add significance stars
significance_stars <- function(p) {
ifelse(p < 0.001, "***", ifelse(p < 0.01, "**", ifelse(p < 0.05, "*", "")))
}
# Apply significance stars
stars <- apply(p_values, c(1, 2), significance_stars)
# Create a summary table
results3 <- data.frame(
Coefficient = as.vector(coeffs),
`p-value` = as.vector(p_values),
Significance = as.vector(stars),
Class = rep(colnames(coeffs), each = nrow(coeffs)),
Variable = rep(rownames(coeffs), times = ncol(coeffs))
)
results3
results
results
results2
results3
install.packages("effects")
library(effects)
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary , data = df_lca)
allEffects(model)
plot(allEffects(model))
dev.off()
plot(allEffects(model))
allEffects(model)
effects <- data.frame(allEffects(model))
View(effects)
results
