df_lca$region_grouped
# Convert to factor and set "Other" as the reference level
df_lca$region_grouped <- relevel(
factor(df_lca$region_grouped),
ref = "Other"
)
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
+ ecosystem
+ encourage_repo_use
+ data_literacy_binary , data = df_lca)
# Summarize model
summary_model <- summary(model)
# Extract coefficients and standard errors
coeffs <- summary_model$coefficients
ses <- summary_model$standard.errors
# Calculate p-values
z_values <- coeffs / ses
p_values <- 2 * (1 - pnorm(abs(z_values)))
# Function to add significance stars
significance_stars <- function(p) {
ifelse(p < 0.001, "***", ifelse(p < 0.01, "**", ifelse(p < 0.05, "*", "")))
}
# Apply significance stars
stars <- apply(p_values, c(1, 2), significance_stars)
# Create a summary table
results <- data.frame(
Coefficient = as.vector(coeffs),
`p-value` = as.vector(p_values),
Significance = as.vector(stars),
Class = rep(colnames(coeffs), each = nrow(coeffs)),
Variable = rep(rownames(coeffs), times = ncol(coeffs))
)
results
df_lca$encourage_data_use <- ifelse(df_lca$Q6.2 == "Strongly agree" |
df_lca$Q6.2 == "Somewhat agree",
1, 0)
df_lca$strong_encourage_data_use <- ifelse(df_lca$Q6.2 == "Strongly agree",
1, 0)
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ encourage_data_use
+ data_literacy_binary , data = df_lca)
# Summarize model
summary_model <- summary(model)
# Extract coefficients and standard errors
coeffs <- summary_model$coefficients
ses <- summary_model$standard.errors
# Calculate p-values
z_values <- coeffs / ses
p_values <- 2 * (1 - pnorm(abs(z_values)))
# Function to add significance stars
significance_stars <- function(p) {
ifelse(p < 0.001, "***", ifelse(p < 0.01, "**", ifelse(p < 0.05, "*", "")))
}
# Apply significance stars
stars <- apply(p_values, c(1, 2), significance_stars)
# Create a summary table
results <- data.frame(
Coefficient = as.vector(coeffs),
`p-value` = as.vector(p_values),
Significance = as.vector(stars),
Class = rep(colnames(coeffs), each = nrow(coeffs)),
Variable = rep(rownames(coeffs), times = ncol(coeffs))
)
results
results
df_lca %>% filter(membership == 1)
df_lca %>% filterclass_(membership == 1)
df_lca %>% filter(class_membership == 1)
df_lca %>% filter(class_membership == 1) %>% select(region_grouped) %>% table()
df_lca %>% filter(class_membership == 1) %>% dplyr::select(region_grouped) %>% table()
df_lca %>% filter(class_membership == 2) %>% dplyr::select(region_grouped) %>% table()
df_lca %>% filter(class_membership == 3) %>% dplyr::select(region_grouped) %>% table()
table(df_lca$class_membership)
table(df_lca$marine_ecosystem)
table(df_lca$freshwater_ecosystem)
table(df_lca$coastal_ecosystem)
table(df_lca$ecosystem)
model <- multinom(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binary , data = df_lca)
# Summarize model
summary_model <- summary(model)
# Extract coefficients and standard errors
coeffs <- summary_model$coefficients
ses <- summary_model$standard.errors
# Calculate p-values
z_values <- coeffs / ses
p_values <- 2 * (1 - pnorm(abs(z_values)))
# Function to add significance stars
significance_stars <- function(p) {
ifelse(p < 0.001, "***", ifelse(p < 0.01, "**", ifelse(p < 0.05, "*", "")))
}
# Apply significance stars
stars <- apply(p_values, c(1, 2), significance_stars)
# Create a summary table
results <- data.frame(
Coefficient = as.vector(coeffs),
`p-value` = as.vector(p_values),
Significance = as.vector(stars),
Class = rep(colnames(coeffs), each = nrow(coeffs)),
Variable = rep(rownames(coeffs), times = ncol(coeffs))
)
results
reg_dat <- df_lca %>% dplyr::select(class_membership,
affiliation_grouped,
area_of_work_grouped,
region_grouped,
# ecosystem,
marine_ecosystem,
freshwater_ecosystem,
coastal_ecosystem,
encourage_data_use,
data_literacy_binary,)
# correlation for all variables
cor <- round(cor(reg_dat),
digits = 2 # rounded to 2 decimals
)
image(cor, main = "Correlation Matrix", col = colorRampPalette(c("blue", "white", "red"))(20))
reg_dat <- df_lca %>% dplyr::select(class_membership,
affiliation_grouped,
area_of_work_grouped,
region_grouped,
# ecosystem,
marine_ecosystem,
freshwater_ecosystem,
coastal_ecosystem,
encourage_data_use,
data_literacy_binary,)
# correlation for all variables
cor <- round(cor(reg_dat),
digits = 2 # rounded to 2 decimals
)
cor(reg_dat)
library(car)
library(nnet)
library(dplyr)
# Fit a multiple linear regression model
model <- lm(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
+ encourage_data_use
+ data_literacy_binar, data = df_lca)
# Fit a multiple linear regression model
model <- lm(class_membership ~
+ affiliation_grouped
+ area_of_work_grouped
+ region_grouped
# + ecosystem
+ marine_ecosystem
+ freshwater_ecosystem
+ coastal_ecosystem
